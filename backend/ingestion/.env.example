# =============================================================================
# Ingestion Service Environment Variables
# =============================================================================
# Copy this file to .env and fill in your values

# -----------------------------------------------------------------------------
# Core Settings
# -----------------------------------------------------------------------------
ENVIRONMENT=dev                    # dev | qa | prod

# -----------------------------------------------------------------------------
# Chunking Strategy
# -----------------------------------------------------------------------------
CHUNK_STRATEGY=semantic             # section | semantic (default: section)
CHUNK_MAX_CHARS=2000               # max characters per chunk
CHUNK_MAX_TOKENS=512               # optional token-based limit

# Chunk overlap (optional)
CHUNK_ENABLE_OVERLAP=false         # true | false
CHUNK_OVERLAP_TOKENS=20             # number of tokens to overlap

# Semantic strategy extras (only used when CHUNK_STRATEGY=semantic)
SEMANTIC_MIN_SIMILARITY=0.40       # similarity threshold for grouping
SEMANTIC_MAX_SENTENCES=25          # max sentences per chunk
SEMANTIC_SIMILARITY_WINDOW=3       # number of sentences in similarity window

# Adaptive threshold (optional)
SEMANTIC_ADAPTIVE_THRESHOLD=true  # true | false
SEMANTIC_TARGET_VARIANCE=0.04      # target similarity variance
SEMANTIC_THRESHOLD_SCALE_MIN=0.7   # min threshold scale
SEMANTIC_THRESHOLD_SCALE_MAX=1.3   # max threshold scale

# -----------------------------------------------------------------------------
# Embedding Provider
# -----------------------------------------------------------------------------
EMBEDDINGS_PROVIDER=huggingface          # azure | huggingface (default: azure)
EMBEDDINGS_DIM=384                   

# --- Azure OpenAI Embeddings (EMBEDDINGS_PROVIDER=azure) ---
EMBEDDINGS_DEPLOYMENT=             # Azure deployment name
EMBEDDINGS_ENDPOINT=               # https://your-resource.openai.azure.com
EMBEDDINGS_API_VERSION=  # API version
EMBEDDINGS_API_KEY=                # API key (or use OAuth below)

# Azure OAuth (alternative to API key)
# AE_AZURE_OAUTH_CLIENT_ID=
# AE_AZURE_OAUTH_CLIENT_SECRET=
# AE_AZURE_OAUTH_TOKEN_URL=

# --- HuggingFace Embeddings (EMBEDDINGS_PROVIDER=huggingface) ---
HUGGINGFACE_MODEL=all-MiniLM-L6-v2 # model name (default: all-MiniLM-L6-v2)
HUGGINGFACE_DEVICE=cpu                # cpu | cuda | mps

# Popular HuggingFace models:
# - all-MiniLM-L6-v2      (384 dims, fast, good for dev)
# - all-mpnet-base-v2     (768 dims, better quality)
# - multi-qa-MiniLM-L6-cos-v1 (384 dims, optimized for Q&A)

# -----------------------------------------------------------------------------
# MongoDB (Required)
# -----------------------------------------------------------------------------
MONGODB_ATLAS_URI=<Your_Mongo_URL_Here>                 # mongodb+srv://user:mailto:pass@cluster.mongodb.net
MONGODB_DB_NAME=pharmacovigilance  # database name
MONGODB_CONTRACTS_COLLECTION=contracts  # collection name
MONGODB_VECTOR_INDEX_NAME=contracts_vector_index  # vector index name

# MongoDB Advanced (optional)
MONGODB_MAX_RETRIES=3
MONGODB_RETRY_SLEEP_MS=500
MONGODB_SERVER_SELECTION_MS=30000
MONGODB_WRITE_CONCERN=majority
MONGODB_DEBUG=false                # true for topology debug logging

# Ingestion behavior
INGEST_PURGE_BEFORE=false          # true to delete existing chunks before upsert

# -----------------------------------------------------------------------------
# Logging
# -----------------------------------------------------------------------------
LOG_LEVEL=INFO                     # DEBUG | INFO | WARNING | ERROR
LOG_JSON=false                     # true for structured JSON output